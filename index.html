<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="manifest" href="manifest.webmanifest">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/png" href="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/160/google/110/jack-o-lantern_1f383.png">
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<title>Plantiet</title>
<style>
::-webkit-scrollbar{display:none;}
*{
font-family:'Roboto',sans-serif;
background-color:#1b262c;
color:#bbe1fa;
}
body{
text-align:center;
height:100%;
user-select:none;
}
i{font-style:normal;}
b{
font-weight:normal;
height:120px;
width:100px;
float:left;
overflow-y:auto;
color:#5fa5d3;
}
a{
position:absolute;
left:64px;
color:orange;
}
</style>
</head>
<body class="notranslate">
<div onclick="r()" style="top:0;left:0;text-align:left;height:100%;width:100%;position:fixed;overflow-x:hidden"></div>
<div style="margin-left:100px;">
<div onclick="h[1].innerHTML=e" style="position:fixed;right:0"><h1 onclick="e++">+</h1><h1 onclick="if(e==0.1)e=0.01;else if(e==0.01)e=1;else e=0.1">1</h1><h1 onclick="e--">--</h1></div><div></div>
<br style="clear:both">
<textarea placeholder=" Search for food"></textarea>
<br><br><div></div>
<script>
navigator.serviceWorker.register('sw.js');
var t=document.querySelector("textarea");
var d=document.querySelectorAll("div");
var h=document.querySelectorAll("h1");
var b=document.getElementsByTagName("b");
var p=document.getElementsByTagName("p");
var n=new XMLHttpRequest();
var u=window.location.href;
var k=u.split("?");
var s=u.split("v");
var i=0;
var e=1;
var v;
var g;
var x;
var z;
var j=[];
if(k[2]==="")localStorage.setItem(0,k[1]);
k[2]=localStorage.getItem(0);
if(!k[2])window.location.href="simplant.html";
while(i<localStorage.length){
if(localStorage.key(i)>0)l(localStorage.key(i))
else if(localStorage.key(i).includes("a")){
x=localStorage.getItem(localStorage.key(i)).split(";");
d[0].innerHTML+="<i id='"+localStorage.key(i)+"' title='"+x[2]+"'>"+x[1]+"</i><a>"+x[0]+"</a><br>";}
i++}
u=u.split("q");
if(u[1]){i=0;
u[0]="";
d[3].innerHTML="";
while(i<u.length-1){
l(u[i+1]);
e=u[i+2];
if(e>0)c(i/2);
i+=2}e=1}
if(s[1]){i=1;
while(i<s.length){
x=localStorage.getItem(s[i]).split(";");
localStorage.setItem(s[i],x[0]+";"+s[i+1]+";"+s[i+2])
i+=3;}}
document.addEventListener("keydown",q=>{
if(h[q.key-1])h[q.key-1].click();
else if(q.key==="Enter"){
n.open("GET","https://api.nal.usda.gov/fdc/v1/foods/search?api_key="+k[2]+"&query="+t.value);
t.value="";
n.send();
n.onload=function(){
j=JSON.parse(n.responseText);
i=0;d[4].innerHTML="<hr>name of food<br><br>ingredients<br><br>brand owner<br><br>data type";
while(i<50){
d[4].innerHTML+="<i id='"+j.foods[i].fdcId+"' onclick='l(this.id);d[4].removeChild(this);'><hr>"+j.foods[i].description+"<br><br>"+j.foods[i].ingredients+"<br><br>"+j.foods[i].brandOwner+"<br><br>"+j.foods[i].dataType+"</i>";
i++}}}})
function l(x){
if(localStorage.getItem(x)){
v=localStorage.getItem(x).split(";");
d[3].innerHTML+="<b id='"+localStorage.getItem(x)+"' onclick='c("+b.length+")'><p>0</p> "+v[1]+"</b>"}
else{
n.open("GET","https://api.nal.usda.gov/fdc/v1/food/"+x+"?api_key="+k[2]);
n.send();
n.onload=function(){
j=JSON.parse(n.responseText);
z=j.foodNutrients;
v=x+";";
v+=j.description;
if(j.ingredients)v+=" ~ "+j.ingredients;
if(j.brandOwner)v+=" ~ "+j.brandOwner;
g=0;
while(g<z.length){
if(z[g].amount)v+=";"+z[g].nutrient.id+";"+z[g].amount;
if(!localStorage.getItem("a"+z[g].nutrient.id))localStorage.setItem("a"+z[g].nutrient.id,z[g].nutrient.name.split('Vitamin ')+" "+z[g].nutrient.unitName+";0;0");
g++}
localStorage.setItem(x,v)
if(u[0]==="")location.reload();
l(x)}}}
function c(x){g=2;
p[x].innerHTML=p[x].innerHTML*1+e*100;
v=b[x].id.split(";");
if(e==0)window.open("https://fdc.nal.usda.gov/fdc-app.html#/food-details/"+v[0]+"/nutrients");
while(g<v.length){
x=document.querySelector("i#a"+v[g]);
x.innerHTML=(x.innerHTML*1+v[g+1]*e).toFixed(6)*1;
if(x.innerHTML<0)x.style.color="#ff6464";
else if(x.title!=0 && x.innerHTML*1>=x.title)x.style.color="#b030b0";
else x.style.color="#bbe1fa";
g+=2}g=0}
function r(){i=0;
if(isNaN(u[0])){u[0]=e;
x=document.querySelectorAll("i");
while(i<x.length){
x[i].innerHTML*=e;
x[i].title*=e;
i++}}
if(d[0].style.width==='100px')
d[0].style.width='100%';
else d[0].style.width='100px';
v="for "+u[0]+" day/s:\n";
g=k[0]+"?";
i=0;
while (i<b.length){
if(p[i].innerHTML!=0){
v+=b[i].textContent+"\n";
x=b[i].id.split(";");
g+="q"+x[0]+"q"+p[i].innerHTML/100;}
i++}
t.value=v+g;
t.select();
document.execCommand("copy");
t.value=""}
</script>
</body>
</html>
